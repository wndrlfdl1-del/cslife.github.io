<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—‘ì…€ ë°ì´í„° ê°€ê³µê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .content {
            padding: 40px;
        }
        
        .upload-section {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }
        
        .upload-section:hover {
            border-color: #2196F3;
            background: #e3f2fd;
        }
        
        .file-input {
            display: none;
        }
        
        .upload-btn {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33,150,243,0.3);
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .control-group label {
            font-weight: 600;
            color: #333;
        }
        
        .control-group select, 
        .control-group input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: #2196F3;
        }
        
        .action-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
        }
        
        .action-btn:hover {
            background: #45a049;
        }
        
        .data-display {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .table-container {
            max-height: 500px;
            overflow: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #f5f5f5;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2196F3;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ì—‘ì…€ ë°ì´í„° ê°€ê³µê¸°</h1>
            <p>ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë°ì´í„°ë¥¼ ë¶„ì„í•´ë³´ì„¸ìš”</p>
        </div>
        
        <div class="content">
            <div class="upload-section" id="uploadSection">
                <h3>ğŸ“ ê¸°ì¤€ ë°ì´í„° íŒŒì¼ ì—…ë¡œë“œ (Aì—´: ì¦ê¶Œë²ˆí˜¸, Bì—´: ì‚¬ìš©ì¸ì½”ë“œ)</h3>
                <p>ì²« ë²ˆì§¸ íŒŒì¼: ê¸°ì¤€ì´ ë˜ëŠ” ë°ì´í„°</p>
                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls" />
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    ê¸°ì¤€ íŒŒì¼ ì„ íƒí•˜ê¸°
                </button>
            </div>
            
            <div class="upload-section" id="matchUploadSection" style="display: none;">
                <h3>ğŸ“Š ë³´ìœ ê³„ì•½ ë°ì´í„° íŒŒì¼ ì—…ë¡œë“œ (Aì—´: ì¦ê¶Œë²ˆí˜¸, Eì—´: ì†Œì†, Hì—´: ìˆ˜ê¸ˆì¸ëª…)</h3>
                <p>ë‘ ë²ˆì§¸ íŒŒì¼: ë§¤ì¹­í•  ë³´ìœ ê³„ì•½ ë°ì´í„°</p>
                <input type="file" id="matchFileInput" class="file-input" accept=".xlsx,.xls" />
                <button class="upload-btn" onclick="document.getElementById('matchFileInput').click()">
                    ë§¤ì¹­ íŒŒì¼ ì„ íƒí•˜ê¸°
                </button>
            </div>
            
            <div id="dataSection" class="hidden">
                <div class="stats" id="statsSection"></div>
                
                <div class="controls">
                    <div class="control-group">
                        <label>ì‹œíŠ¸ ì„ íƒ:</label>
                        <select id="sheetSelect"></select>
                    </div>
                    <div class="control-group">
                        <label>ì •ë ¬ ê¸°ì¤€:</label>
                        <select id="sortColumn"></select>
                    </div>
                    <div class="control-group">
                        <label>ì •ë ¬ ë°©í–¥:</label>
                        <select id="sortOrder">
                            <option value="asc">ì˜¤ë¦„ì°¨ìˆœ</option>
                            <option value="desc">ë‚´ë¦¼ì°¨ìˆœ</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>í•„í„°:</label>
                        <input type="text" id="filterInput" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥">
                    </div>
                    <button class="action-btn" onclick="applyFilters()">ì ìš©</button>
                    <button class="action-btn" onclick="matchData()" id="matchBtn" style="display: none;">ë°ì´í„° ë§¤ì¹­ ì‹¤í–‰</button>
                    <button class="action-btn" onclick="downloadProcessedData()">ê°€ê³µëœ ë°ì´í„° ë‹¤ìš´ë¡œë“œ</button>
                </div>
                
                <div class="data-display">
                    <div class="table-container">
                        <table id="dataTable">
                            <thead id="tableHead"></thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let workbook = null;
        let matchWorkbook = null;
        let currentData = [];
        let matchFileData = [];
        let originalData = [];
        let currentSheet = '';
        let matchedData = [];

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        document.getElementById('fileInput').addEventListener('change', handleFile);
        document.getElementById('matchFileInput').addEventListener('change', handleMatchFile);
        
        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        const uploadSection = document.getElementById('uploadSection');
        uploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadSection.style.borderColor = '#2196F3';
            uploadSection.style.background = '#e3f2fd';
        });
        
        uploadSection.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadSection.style.borderColor = '#dee2e6';
            uploadSection.style.background = '#f8f9fa';
        });
        
        uploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadSection.style.borderColor = '#dee2e6';
            uploadSection.style.background = '#f8f9fa';
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        });

        function handleFile(e) {
            const file = e.target.files[0];
            if (file) {
                processFile(file, 'base');
            }
        }

        function handleMatchFile(e) {
            const file = e.target.files[0];
            if (file) {
                processFile(file, 'match');
            }
        }

        function processFile(file, type) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    if (type === 'base') {
                        workbook = XLSX.read(e.target.result, {type: 'binary'});
                        setupSheetSelector();
                        loadSheet(workbook.SheetNames[0]);
                        document.getElementById('dataSection').classList.remove('hidden');
                        document.getElementById('matchUploadSection').style.display = 'block';
                    } else if (type === 'match') {
                        matchWorkbook = XLSX.read(e.target.result, {type: 'binary'});
                        loadMatchData();
                        document.getElementById('matchBtn').style.display = 'inline-block';
                    }
                } catch (error) {
                    alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            };
            reader.readAsBinaryString(file);
        }

        function setupSheetSelector() {
            const sheetSelect = document.getElementById('sheetSelect');
            sheetSelect.innerHTML = '';
            
            workbook.SheetNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                sheetSelect.appendChild(option);
            });
            
            sheetSelect.addEventListener('change', (e) => {
                loadSheet(e.target.value);
            });
        }

        function loadSheet(sheetName) {
            currentSheet = sheetName;
            const worksheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
            
            if (jsonData.length === 0) {
                alert('ì„ íƒí•œ ì‹œíŠ¸ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í—¤ë”ì™€ ë°ì´í„° ë¶„ë¦¬
            const headers = jsonData[0];
            const rows = jsonData.slice(1);
            
            // ê°ì²´ ë°°ì—´ë¡œ ë³€í™˜
            originalData = rows.map(row => {
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = row[index] || '';
                });
                return obj;
            });
            
            currentData = [...originalData];
            
            setupColumnSelector(headers);
            displayData();
            showStats();
        }

        function setupColumnSelector(headers) {
            const sortColumn = document.getElementById('sortColumn');
            sortColumn.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
            
            headers.forEach(header => {
                const option = document.createElement('option');
                option.value = header;
                option.textContent = header;
                sortColumn.appendChild(option);
            });
        }

        function displayData() {
            const tableHead = document.getElementById('tableHead');
            const tableBody = document.getElementById('tableBody');
            
            if (currentData.length === 0) {
                tableHead.innerHTML = '';
                tableBody.innerHTML = '<tr><td colspan="100%">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                return;
            }
            
            // í—¤ë” ìƒì„±
            const headers = Object.keys(currentData[0]);
            tableHead.innerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
            
            // ë°ì´í„° í–‰ ìƒì„±
            tableBody.innerHTML = currentData.map(row => 
                '<tr>' + headers.map(h => `<td>${row[h]}</td>`).join('') + '</tr>'
            ).join('');
        }

        function showStats() {
            const statsSection = document.getElementById('statsSection');
            
            const totalRows = currentData.length;
            const totalColumns = currentData.length > 0 ? Object.keys(currentData[0]).length : 0;
            
            // ìˆ«ì ì»¬ëŸ¼ë“¤ì˜ í•©ê³„/í‰ê·  ê³„ì‚°
            const numericStats = calculateNumericStats();
            
            let statsHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalRows.toLocaleString()}</div>
                    <div class="stat-label">ì´ í–‰ ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalColumns}</div>
                    <div class="stat-label">ì´ ì—´ ìˆ˜</div>
                </div>
            `;
            
            numericStats.forEach(stat => {
                statsHTML += `
                    <div class="stat-card">
                        <div class="stat-value">${stat.value}</div>
                        <div class="stat-label">${stat.label}</div>
                    </div>
                `;
            });
            
            statsSection.innerHTML = statsHTML;
        }

        function calculateNumericStats() {
            if (currentData.length === 0) return [];
            
            const stats = [];
            const headers = Object.keys(currentData[0]);
            
            headers.forEach(header => {
                const values = currentData.map(row => parseFloat(row[header])).filter(v => !isNaN(v));
                if (values.length > 0) {
                    const sum = values.reduce((a, b) => a + b, 0);
                    const avg = sum / values.length;
                    stats.push({
                        value: avg.toLocaleString(undefined, {maximumFractionDigits: 2}),
                        label: `${header} í‰ê· `
                    });
                }
            });
            
            return stats.slice(0, 4); // ìµœëŒ€ 4ê°œê¹Œì§€ë§Œ í‘œì‹œ
        }

        function applyFilters() {
            let filteredData = [...originalData];
            
            // í•„í„° ì ìš©
            const filterText = document.getElementById('filterInput').value.toLowerCase();
            if (filterText) {
                filteredData = filteredData.filter(row => 
                    Object.values(row).some(value => 
                        String(value).toLowerCase().includes(filterText)
                    )
                );
            }
            
            // ì •ë ¬ ì ìš©
            const sortColumn = document.getElementById('sortColumn').value;
            const sortOrder = document.getElementById('sortOrder').value;
            
            if (sortColumn) {
                filteredData.sort((a, b) => {
                    let aVal = a[sortColumn];
                    let bVal = b[sortColumn];
                    
                    // ìˆ«ìì¸ì§€ í™•ì¸
                    const aNum = parseFloat(aVal);
                    const bNum = parseFloat(bVal);
                    
                    if (!isNaN(aNum) && !isNaN(bNum)) {
                        return sortOrder === 'asc' ? aNum - bNum : bNum - aNum;
                    } else {
                        aVal = String(aVal).toLowerCase();
                        bVal = String(bVal).toLowerCase();
                        if (sortOrder === 'asc') {
                            return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
                        } else {
                            return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
                        }
                    }
                });
            }
            
            currentData = filteredData;
            displayData();
            showStats();
        }

        function downloadProcessedData() {
            if (currentData.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const ws = XLSX.utils.json_to_sheet(currentData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ê°€ê³µëœë°ì´í„°");
            
            const fileName = `ê°€ê³µëœë°ì´í„°_${new Date().toISOString().slice(0,10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
        }

        function loadMatchData() {
            const worksheet = matchWorkbook.Sheets[matchWorkbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
            
            if (jsonData.length === 0) {
                alert('ë§¤ì¹­ íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const headers = jsonData[0];
            const rows = jsonData.slice(1);
            
            matchFileData = rows.map(row => {
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = row[index] || '';
                });
                return obj;
            });
            
            alert(`ë§¤ì¹­ ë°ì´í„° ${matchFileData.length}ê±´ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        function matchData() {
            if (!workbook || !matchWorkbook) {
                alert('ë‘ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (originalData.length === 0 || matchFileData.length === 0) {
                alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë§¤ì¹­ ë°ì´í„°ë¥¼ ì¦ê¶Œë²ˆí˜¸ë¡œ ì¸ë±ì‹±
            const matchIndex = {};
            matchFileData.forEach(row => {
                const headers = Object.keys(row);
                const securityNumber = row[headers[0]]; // Aì—´ (ì¦ê¶Œë²ˆí˜¸)
                if (securityNumber) {
                    matchIndex[securityNumber] = {
                        ì†Œì†: row[headers[4]] || '', // Eì—´ (ì†Œì†)
                        ìˆ˜ê¸ˆì¸ëª…: row[headers[7]] || '' // Hì—´ (ìˆ˜ê¸ˆì¸ëª…)
                    };
                }
            });
            
            // ê¸°ì¤€ ë°ì´í„°ì— ë§¤ì¹­ ì •ë³´ ì¶”ê°€
            matchedData = originalData.map(row => {
                const headers = Object.keys(row);
                const securityNumber = row[headers[0]]; // Aì—´ (ì¦ê¶Œë²ˆí˜¸)
                const matchInfo = matchIndex[securityNumber];
                
                return {
                    ...row,
                    'ë§¤ì¹­_ì†Œì†': matchInfo ? matchInfo.ì†Œì† : 'ë§¤ì¹­ì•ˆë¨',
                    'ë§¤ì¹­_ìˆ˜ê¸ˆì¸ëª…': matchInfo ? matchInfo.ìˆ˜ê¸ˆì¸ëª… : 'ë§¤ì¹­ì•ˆë¨'
                };
            });
            
            // ë§¤ì¹­ëœ ê±´ìˆ˜ ê³„ì‚°
            const matchedCount = matchedData.filter(row => 
                row['ë§¤ì¹­_ì†Œì†'] !== 'ë§¤ì¹­ì•ˆë¨' && row['ë§¤ì¹­_ìˆ˜ê¸ˆì¸ëª…'] !== 'ë§¤ì¹­ì•ˆë¨'
            ).length;
            
            alert(`ë§¤ì¹­ ì™„ë£Œ: ì´ ${originalData.length}ê±´ ì¤‘ ${matchedCount}ê±´ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            
            // ë§¤ì¹­ëœ ë°ì´í„°ë¥¼ í˜„ì¬ ë°ì´í„°ë¡œ ì„¤ì •
            currentData = [...matchedData];
            displayData();
            showStats();
        }

        function loadMatchData() {
            const worksheet = matchWorkbook.Sheets[matchWorkbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
            
            if (jsonData.length === 0) {
                alert('ë§¤ì¹­ íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const headers = jsonData[0];
            const rows = jsonData.slice(1);
            
            matchData = rows.map(row => {
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = row[index] || '';
                });
                return obj;
            });
            
            alert(`ë§¤ì¹­ ë°ì´í„° ${matchData.length}ê±´ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        function matchData() {
            if (!workbook || !matchWorkbook) {
                alert('ë‘ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (originalData.length === 0 || matchData.length === 0) {
                alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë§¤ì¹­ ë°ì´í„°ë¥¼ ì¦ê¶Œë²ˆí˜¸ë¡œ ì¸ë±ì‹±
            const matchIndex = {};
            matchData.forEach(row => {
                const headers = Object.keys(row);
                const securityNumber = row[headers[0]]; // Aì—´ (ì¦ê¶Œë²ˆí˜¸)
                if (securityNumber) {
                    matchIndex[securityNumber] = {
                        ì†Œì†: row[headers[4]] || '', // Eì—´ (ì†Œì†)
                        ìˆ˜ê¸ˆì¸ëª…: row[headers[7]] || '' // Hì—´ (ìˆ˜ê¸ˆì¸ëª…)
                    };
                }
            });
            
            // ê¸°ì¤€ ë°ì´í„°ì— ë§¤ì¹­ ì •ë³´ ì¶”ê°€
            matchedData = originalData.map(row => {
                const headers = Object.keys(row);
                const securityNumber = row[headers[0]]; // Aì—´ (ì¦ê¶Œë²ˆí˜¸)
                const matchInfo = matchIndex[securityNumber];
                
                return {
                    ...row,
                    'ë§¤ì¹­_ì†Œì†': matchInfo ? matchInfo.ì†Œì† : 'ë§¤ì¹­ì•ˆë¨',
                    'ë§¤ì¹­_ìˆ˜ê¸ˆì¸ëª…': matchInfo ? matchInfo.ìˆ˜ê¸ˆì¸ëª… : 'ë§¤ì¹­ì•ˆë¨'
                };
            });
            
            // ë§¤ì¹­ëœ ê±´ìˆ˜ ê³„ì‚°
            const matchedCount = matchedData.filter(row => 
                row['ë§¤ì¹­_ì†Œì†'] !== 'ë§¤ì¹­ì•ˆë¨' && row['ë§¤ì¹­_ìˆ˜ê¸ˆì¸ëª…'] !== 'ë§¤ì¹­ì•ˆë¨'
            ).length;
            
            alert(`ë§¤ì¹­ ì™„ë£Œ: ì´ ${originalData.length}ê±´ ì¤‘ ${matchedCount}ê±´ ë§¤ì¹­ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            
            // ë§¤ì¹­ëœ ë°ì´í„°ë¥¼ í˜„ì¬ ë°ì´í„°ë¡œ ì„¤ì •
            currentData = [...matchedData];
            displayData();
            showStats();
        }

        function downloadProcessedData() {
            let dataToDownload = currentData;
            
            // ë§¤ì¹­ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©
            if (matchedData.length > 0) {
                dataToDownload = matchedData;
            }
            
            if (dataToDownload.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const ws = XLSX.utils.json_to_sheet(dataToDownload);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ê°€ê³µëœë°ì´í„°");
            
            const fileName = `ê°€ê³µëœë°ì´í„°_${new Date().toISOString().slice(0,10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
        }
    </script>
</body>
</html>
